name: "FedEx composite action eg"
description: "FedEx composite action eg steps are mentioned below"

inputs:
  devops-integration-user-name:
    description: "The username for DevOps integration."
    required: true
  devops-integration-user-password:
    description: "The password for DevOps integration."
    required: true
  instance-url:
    description: "The URL of the ServiceNow instance."
    required: true
  tool-id:
    description: "The ID of the Orchestration Tool."
    required: true
  context-github:
    description: "GitHub Context."
    required: true

runs:
  using: "composite"
  steps:
    - name: call-composite-action-test
      uses: ServiceNow/servicenow-devops-test-report@main
      with:
        devops-integration-user-name: ${{ inputs.devops-integration-user-name }}
        devops-integration-user-password: ${{ inputs.devops-integration-user-password }}
        instance-url: 'https://empkiranv02.service-now.com/'
        tool-id: ${{ inputs.tool-id }}
        job-name: 'call-composite-action-test / Test'
        context-github: ${{ inputs.context-github }}
        xml-report-filename: valid-xunit.xml

    - name: Open change
      id: open_pdsm_change
      uses: ServiceNow/servicenow-devops-change@v2.0.0
      with:
        instance-url: 'https://empkiranv02.service-now.com/'
        devops-integration-token: 'BTukZQkGrjazLvvCrd5m9YnfCVHveH92'
        tool-id: ${{ inputs.tool-id }}
        job-name: 'Open change / Test'
        context-github: ${{ inputs.context-github }}
        change-request: '{"setCloseCode":"true","attributes":{"short_description":"Automated Software Deployment","description":"Automated Software Deployment.","assignment_group":"a715cd759f2002002920bde8132e7018","implementation_plan":"Software update is tested and results can be found in Test Summaries Tab; When the change is approved the implementation happens automated by the CICD pipeline within the change planned start and end time window.","backout_plan":"When software fails in production, the previous software release will be re-deployed.","test_plan":"Testing if the software was successfully deployed"}}'
      

    # - name: Checkout Code
    #   uses: actions/checkout@v2

    # - name: Setup JDK 11 for Sonar Cloud
    #   uses: actions/setup-java@v1
    #   with:
    #     java-version: 11

    # - name: Maven Build
    #   run: mvn clean install -DskipTests=true

    # - name: Build change request payload
    # id: build-change-payload
    # uses: Fedex/eai-3538069-pdsm/devops-changes@main
    
    # - name: Open Change
    # if: needs.compliance_ppm.outputs.skip-compliance != 'true' && steps.skip.outputs.skip-pdsm != 'true'
    # id: open_pdsm_change
    # uses: ServiceNow/servicenow-devops-change@v2.0.0
